Object.defineProperty(exports,"__esModule",{value:true});exports.wordData=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _DB=require('../constants/DB');var _Meta=require('../constants/Meta');function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}var initialState={ALL_WORDS:[],SORTED_SCORES:[]};var wordData=exports.wordData=function wordData(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments[1];switch(action.type){case'GET_ALL_WORDS':var words=action.words.map(function(item){return JSON.parse(item[1]);});words.sort(function(a,b){return a[_DB.INDEX]-b[_DB.INDEX];});var sortedScores=[];for(var i=0;i<words.length;i++){sortedScores.push([i,words[i][_DB.SCORE]]);}sortedScores.sort(function(first,second){return first[1]-second[1];});sortedScores=sortedScores.map(function(item){return item[0];});return{ALL_WORDS:words,SORTED_SCORES:sortedScores};case'EDIT_WORD':if(_Meta.VERBOSE>=5){console.log('WordDataReducer: EDIT_WORD - '+action[_DB.WORD]);}if(action.wordNotExisted){var reducerEditWordMap=function reducerEditWordMap(wordObj){if(action[_DB.INDEX]===wordObj[_DB.INDEX]){var _word=_extends({},wordObj);_word[_DB.WORD]=action[_DB.WORD];_word[_DB.DEFINITION]=action[_DB.DEFINITION];_word[_DB.NOUN]=action[_DB.NOUN];_word[_DB.VERB]=action[_DB.VERB];_word[_DB.ADJECTIVE]=action[_DB.ADJECTIVE];_word[_DB.ADVERB]=action[_DB.ADVERB];return _word;}else{return wordObj;}};return{ALL_WORDS:state.ALL_WORDS.map(reducerEditWordMap),SORTED_SCORES:state.SORTED_SCORES.map(reducerEditWordMap)};}else{var reducerEditWordReduce=function reducerEditWordReduce(array,wordObj){if(action[_DB.INDEX]===wordObj[_DB.INDEX]){var _word2=_extends({},wordObj);_word2[_DB.WORD]=action[_DB.WORD];_word2[_DB.DEFINITION]=action[_DB.DEFINITION];_word2[_DB.NOUN]=action[_DB.NOUN];_word2[_DB.VERB]=action[_DB.VERB];_word2[_DB.ADJECTIVE]=action[_DB.ADJECTIVE];_word2[_DB.ADVERB]=action[_DB.ADVERB];array.push(_word2);}else{if(action[_DB.WORD]!==wordObj[_DB.WORD]){array.push(wordObj);}}return array;};return{ALL_WORDS:state.ALL_WORDS.reduce(reducerEditWordReduce,[]),SORTED_SCORES:state.SORTED_SCORES.reduce(reducerEditWordReduce,[])};}case'ADD_WORD':var word={};word[_DB.INDEX]=state.ALL_WORDS[state.ALL_WORDS.length-1][_DB.INDEX]+1;word[_DB.WORD]=action.word;word[_DB.DEFINITION]=action.def;word[_DB.NOUN]=action.n;word[_DB.VERB]=action.v;word[_DB.ADJECTIVE]=action.adj,word[_DB.ADVERB]=action.adv;return{ALL_WORDS:[].concat(_toConsumableArray(state.ALL_WORDS),[word]),SORTED_SCORES:[state.ALL_WORDS.length].concat(_toConsumableArray(state.SORTED_SCORES))};case'CHANGE_WORD_SCORE':return{ALL_WORDS:state.ALL_WORDS.map(function(wordObj){return wordObj[_DB.INDEX]===action.id?_extends({},wordObj,{score:wordObj.score+action.val}):wordObj;}),SORTED_SCORES:state.SORTED_SCORES};case'DELETE_WORD':if(_Meta.VERBOSE>=5){console.log('WordDataReducer: DELETE_WORD for '+action.word);}return{ALL_WORDS:state.ALL_WORDS.filter(function(wordObj){return wordObj[_DB.WORD]!==action.word;}),SORTED_SCORES:state.SORTED_SCORES.filter(function(wordObj){return wordObj[_DB.WORD]!==action.word;})};default:return state;}};